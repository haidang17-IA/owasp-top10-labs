\# Logic to Solve â€“ XXE to Perform SSRF



\## Lab title

Exploiting XXE to perform SSRF attacks  

(PortSwigger Web Security Academy)



\## Goal

Exploit an XXE vulnerability to make the server send a request to an internal resource using SSRF (Server-Side Request Forgery).



\## What is the vulnerability?

\- The server parses user-supplied XML using an insecure parser.

\- The parser allows external entities that can load content from URLs.

\- We define an entity that points to a URL on the internal network.

\- The application uses the entity in its response.



\## Why this works

\- When the parser encounters `\&xxe;`, it fetches the URL defined in the external entity.

\- If the URL is internal (like metadata servers), the server may return sensitive data.



\## Technical explanation

\- Define an entity: `<!ENTITY xxe SYSTEM "http://169.254.169.254/...">`

\- Insert `\&xxe;` into a reflected tag like `<productId>`.

\- Observe the response to see if the request succeeded and data was returned.



\## Impact

\- Access to cloud metadata endpoints (AWS EC2, GCP, etc.).

\- Possible leakage of cloud credentials and tokens.

\- Potential full compromise of the application or environment.



