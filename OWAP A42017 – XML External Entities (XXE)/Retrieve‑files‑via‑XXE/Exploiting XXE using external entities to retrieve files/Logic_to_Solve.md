\#  Logic to Solve â€“ XXE: Retrieve Files



\##  Goal

Use an XXE (XML External Entity) attack to read a file from the server (for example: `/etc/passwd`).



---



\##  What is the vulnerability?

\- The server accepts XML input and parses it using an unsafe XML parser.

\- The parser allows external entities like `<!ENTITY xxe SYSTEM "file:///etc/passwd">`.

\- The application reflects user input (like `<productId>`) in the HTTP response.



---



\##  Why this works

\- The server doesn't block `DOCTYPE` or external entity definitions.

\- When it sees `\&xxe;`, it loads content from the file path we give.

\- The response includes the content of that file.



---



\##  Technical breakdown

\- Declare an external entity that points to a file path.

\- Replace part of the XML value (like `<productId>`) with `\&xxe;`.

\- When the XML is processed, `\&xxe;` is replaced with the file's content.



---



\##  Impact

\- Attacker can read system files (like `/etc/passwd`, `.env`, or `secret.txt`).

\- Might find credentials, tokens, or server configurations.

\- Could lead to bigger attacks like SSRF or RCE.





